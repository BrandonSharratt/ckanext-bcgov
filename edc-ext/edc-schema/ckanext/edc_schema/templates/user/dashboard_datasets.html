{% extends "user/dashboard.html" %}

{% block dashboard_activity_stream_context %}{% endblock %}

{% block page_primary_action %}
	{% set user_orgs = h.get_user_orgs(c.userobj.id) or null %}
	{% if h.check_access('package_create') and (user_orgs or c.userobj.sysadmin == True) %}
    {% link_for _('Add Dataset'), controller='ckanext.edc_schema.controllers.package:EDCPackageController', action='typeSelect', class_="btn btn-primary", icon="plus-sign-alt" %}
  {% endif %}
{% endblock %}


{% block primary_content_inner %}
  <div class="dashboard-counter" >
  	<h3>
     {%- if c.page.item_count -%}
            {{ c.page.item_count }} datasets found.
     {%- else -%}
            {{ _('No datasets found') }}
    {%- endif -%}
    </h3>
 </div>
<div class="clearfix">
  <h2 class="hide-heading">{{ _('My Datasets') }}</h2>
  <div class="primary">
    {% block packages_list %}
    {% if c.page.items %}
      {{ h.snippet('snippets/package_list.html', packages=c.page.items) }}
    {% endif %}
  {% endblock %}
  </div>
<aside class="tertiary">
{% block tertiary_content %}
    {% block user_search_form %}
      {% set sorting = [
            (_('Name Ascending'), 'title_string asc'),
            (_('Name Descending'), 'title_string desc'),
            (_('Last Modified'), 'data_modified desc') ]
      %}
      {% snippet 'snippets/search_form.html', type='dataset', query=c.q, sorting=sorting, sorting_selected=c.sort_by_selected, no_title=true, search_class=' ' %}
    {% endblock %}

  {% for facet in c.facet_titles %}
    	{{ h.snippet('snippets/facet_list.html', title=c.facet_titles[facet], name=facet) }}
  {% endfor %}
{% endblock %}
</aside>
</div>
 {{ c.page.pager() }}
{% endblock %} 